{% extends "blog/base.html" %}

{% block headcss %}{% endblock %}

{% block content %}

  <!-- 主体页面 包括文章索引,分页,右侧部件 -->
  {% include "blog/_page.html" %}
  <!-- 注册模态框 -->
  {% include "blog/_register.html" %}
  <!-- 登录模态框 -->
  {% include "blog/_login.html" %}

{% endblock %}

{% block tailscript %}
  <!-- 注册登录模态框相互跳转使用js防止出现滚动条隐藏模态框抖动 -->
  <script src="../../static/blog/js/modal_redirect.js"></script>
  <script>

    function isEmpty(obj){
      if(obj==undefined || obj==null || obj==''){
        return true;
      }
      return false;
    }

    $(document).ready(function(){
      $('#lcomplain').hide();
      $('#lsuccess').hide();
      $('#lfail').hide();

      $('#loginbtn').click(function(){
        var username = $('#username1').val()
        var password = $('#password1').val()
        console.log(username);
        console.log(isEmpty(username));
        if(isEmpty(username) || isEmpty(password)){
          $('#lcomplain').show();
          $('#lcomplain').html('请填写用户名和密码！');
          setTimeout(function(){
            $('#lcomplain').hide();
          }, 5000)
          return;
        }


        $.ajax({
          url: '/login',
          data: $('#loginForm').serialize(),
          type: 'POST',
          success: function(res){
            //console.log(response);
            if(res.status == true){
              $('#lsuccess').show();
              $('#lsuccess').html(res.msg);
              location.reload();
            }else{
              $('#lfail').show();
              $('#lfail').append(res.msg);
              setTimeout(function(){
                $('#lfail').html('<strong>登录失败：</strong>');
                $('#lfail').hide();
              }, 5000);
            }
          },
          error: function(error){
            console.log(error);
          }
        })
      })
    });
  </script>
{% endblock %}